(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const st=new Map;function pe(e){let t=st.get(e);return t===void 0&&(t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),st.set(e,t)),t}function He(e){return`<${String(e.tagName).toLowerCase()}>`}function Ve(e,t){e.nodeType===globalThis.Node.ELEMENT_NODE&&(t(e),e.shadowRoot&&Ve(e.shadowRoot,t));const n=globalThis.document.createTreeWalker(e,globalThis.NodeFilter.SHOW_ELEMENT,null,!1);for(;n.nextNode();){const r=n.currentNode;t(r),r.shadowRoot&&Ve(r.shadowRoot,t)}}const xe=Promise.resolve(),ve=new WeakMap;let H=new Set;function zt(e){H.size===0&&(H=new Set,xe.then(en)),H.add(e)}function Zt(e){H.delete(e)}function en(){for(const e of H)try{e()}catch(t){console.error(t)}H.clear()}const se=new WeakMap,ne=new Set;function Ye(e){const t=[];let n=0;for(;e;){if(e.resolved=!1,e.contexts)for(const r of e.contexts)!ne.has(r)&&!t.includes(r)&&t.push(r);e.observe&&zt(e.observe),e=t[n++]}}function k(e,t){let n=se.get(e);n||(n=new Map,se.set(e,n));let r=n.get(t);return r||(r={key:t,target:e,value:void 0,assertValue:void 0,lastValue:void 0,resolved:!1,contexts:void 0,deps:void 0,observe:void 0},n.set(t,r)),r}function Wt(e){const t=se.get(e);return t?[...t.values()]:[]}let P=null;function _t(){return P?.value}function _(e,t,n){const r=k(e,t);if(P&&(r.contexts||(r.contexts=new Set),P.deps||(P.deps=new Set),r.contexts.add(P),P.deps.add(r)),r.resolved)return r.value;if(r.deps){for(const o of r.deps)o.contexts.delete(r);r.deps.clear()}const i=P;try{if(ne.has(r))throw Error(`Circular get invocation is forbidden: '${t}'`);P=r,ne.add(r),r.value=n(e,r.assertValue),r.resolved=!0,P=i,ne.delete(r)}catch(o){throw P=i,ne.delete(r),P&&(P.deps.delete(r),r.contexts.delete(P)),o}return r.value}function Qe(e,t,n,r){if(P&&P.target===e&&!r)throw Error(`Try to update the '${t}' property while getting the '${P.key}' property`);const i=k(e,t);i.value=void 0,i.assertValue=n,Ye(i)}function tn(e,t,n,r){const i=k(e,t),o=n(e,r,i.value);o!==i.value&&(i.value=o,i.assertValue=void 0,Ye(i))}function nn(e,t,n,r){const i=k(e,t);i.observe=()=>{const o=_(e,t,n);o!==i.lastValue&&(r(e,o,i.lastValue),i.lastValue=o)};try{i.observe()}catch(o){console.error(o)}return()=>{i.observe=void 0,i.lastValue=void 0}}const he=new Set;function rn(e){he.size||setTimeout(()=>{for(const t of he)(!t.contexts||t.contexts.size===0)&&se.get(t.target).delete(t.key);he.clear()}),he.add(e)}function Rt(e,t){if(Ye(e),t.clearValue&&(e.value=void 0,e.assertValue=void 0,e.lastValue=void 0),t.deleteEntry){if(e.deps){for(const n of e.deps)n.contexts.delete(e);e.deps=void 0}if(e.contexts){for(const n of e.contexts)n.deps.delete(e);e.contexts=void 0}rn(e)}}function Ne(e,t,n={}){const r=k(e,t);Rt(r,n)}function Dt(e,t={}){const n=se.get(e);if(n)for(const r of n.values())Rt(r,t)}function on(e){if(e.reflect)throw TypeError("'reflect' option is not supported for 'render' property");const{value:t,observe:n}=e;if(typeof t!="function")throw TypeError(`Value for 'render' property must be a function: ${typeof t}`);const r={connect:e.connect,observe:n?(o,s,l)=>{n(o,s(),l)}:(o,s)=>{s()}},i=e.shadow?{mode:e.shadow.mode||"open",delegatesFocus:e.shadow.delegatesFocus||!1}:e.shadow;return i?r.value=o=>{const s=o.shadowRoot||o.attachShadow(i),l=t(o);return()=>(l(o,s),s)}:i===!1?r.value=o=>{const s=t(o);return()=>(s(o,o),o)}:r.value=o=>{const s=t(o);return()=>s(o)},r}function ct(e,t,n){!t&&t!==0?e.removeAttribute(n):e.setAttribute(n,t===!0?"":t)}function sn(e,t){const n=typeof t.value,r=n==="object"?Object.freeze(t.value):t.value;switch(n){case"string":t.value=(o,s)=>s!==void 0?String(s):r;break;case"number":t.value=(o,s)=>s!==void 0?Number(s):r;break;case"boolean":t.value=(o,s)=>s!==void 0?!!s:r;break;case"function":t.value=r;break;default:t.value=(o,s=r)=>s}let i=t.observe;if(t.reflect){const o=pe(e),s=typeof t.reflect=="function"?(l,f,h)=>ct(l,t.reflect(f),h):ct;i=t.observe?(l,f,h)=>{s(l,f,o),t.observe(l,f,h)}:(l,f)=>s(l,f,o)}return{...t,observe:i,writable:n!=="function"||r.length>1}}const ce=new WeakMap,lt=new WeakMap,at=new WeakMap;function cn(e,t){for(const n of this.connects)t.add(n(e));for(const n of this.observers)t.add(n(e))}function Be(e,t){if(t){const o=ce.get(t);if(e===o)return t;for(const s of Object.keys(o))s!=="tag"&&delete t.prototype[s]}else t=class extends globalThis.HTMLElement{constructor(){super();for(const o of t.writable)if(hasOwnProperty.call(this,o)){const s=this[o];delete this[o],this[o]=s}else{const s=this.getAttribute(pe(o));s!==null&&(this[o]=s===""&&typeof this[o]=="boolean"||s)}}connectedCallback(){const o=new Set;at.set(this,o);const s=cn.bind(t,this,o);lt.set(this,s),zt(s)}disconnectedCallback(){Zt(lt.get(this));for(const o of at.get(this))o&&o();Dt(this)}};ce.set(t,Object.freeze(e));const n=new Set,r=new Set,i=new Set;for(const o of Object.keys(e)){if(o==="tag")continue;let s=e[o];if(typeof s!="object"||s===null)s={value:s};else if(!hasOwnProperty.call(s,"value"))throw TypeError(`The 'value' option is required for '${o}' property of the '${e.tag}' element`);s=o==="render"?on(s):sn(o,s),s.writable&&i.add(o),Object.defineProperty(t.prototype,o,{get:function(){return _(this,o,s.value)},set:s.writable?function(f){Qe(this,o,f)}:void 0,enumerable:!0,configurable:!0}),s.connect&&n.add(l=>s.connect(l,o,()=>{Ne(l,o)})),s.observe&&r.add(l=>nn(l,o,s.value,s.observe))}return t.connects=n,t.observers=r,t.writable=i,t}const ee=new Map;function ln(e){ee.size||xe.then(()=>{Ve(globalThis.document.body,t=>{if(ee.has(t.constructor)){const n=ee.get(t.constructor),r=ce.get(t.constructor);t.disconnectedCallback();for(const i of Object.keys(r)){const o=typeof r[i],s=o!=="object"&&o!=="function"&&r[i]!==n[i];s&&t.removeAttribute(pe(i)),Ne(t,i,{clearValue:s})}t.connectedCallback()}}),ee.clear()}),ee.set(e,ce.get(e))}const me=new Set;function Gt(e){if(!e.tag)throw TypeError("Error while defining an element: 'tag' property with dashed tag name is required");if(me.has(e.tag))throw TypeError(`Error while defining '${e.tag}' element: tag name is already defined`);me.size||xe.then(()=>me.clear()),me.add(e.tag);const t=globalThis.customElements.get(e.tag);if(t){if(ce.get(t))return ln(t),Be(e,t),e;throw TypeError(`Custom element with '${e.tag}' tag name already defined outside of the hybrids context`)}return globalThis.customElements.define(e.tag,Be(e)),e}function an(e,{root:t="",prefix:n}={}){for(const r of Object.keys(e)){const i=e[r];if(!i.tag){const o=pe([].concat(t).reduce((s,l)=>s.replace(l,""),r).replace(/^[./]+/,"").replace(/\//g,"-").replace(/\.[a-zA-Z]+$/,""));i.tag=n?`${n}-${o}`:o}Gt(i)}return e}const je=Object.freeze(Object.assign(Gt,{compile:e=>Be(e),from:an})),Ze=Symbol("store.connect"),O=new WeakMap,Pe=new WeakMap,F=new WeakMap;function et(e,t,n){if(n&&(O.set(n,null),Pe.set(n,t)),O.set(t,e),F.has(e)){const r=t&&e.isInstance(t)?t:null,i=n&&e.isInstance(n)?n:null;if(r!==i){let o=i?i.id:r.id;F.get(e).forEach(s=>{try{s(o,r,i)}catch(l){console.error(l)}})}}return t}function fn(e,t,n){return et(e,t,n),e.invalidate&&(e.storage.loose||!n||!e.isInstance(n))&&e.invalidate(),t}function U(e,t,n,r=!0){return tn(e,t,r?fn:et,n),n}let ge;function L(){return ge||(ge=Date.now(),xe.then(()=>{ge=void 0})),ge}const $e=new WeakMap;function Ae(e){let t=$e.get(e);return t||(t=L(),$e.set(e,t)),t}function be(e){return $e.set(e,L()),e}function ft(e){return $e.set(e,1),e}function Fe(e){return globalThis.btoa(Array.from(e).reduce((t,n)=>Math.imul(31,t)+n.charCodeAt(0)|0,0))}const Me="hybrids:store:cache",Ie={};let ke;function un(e,t){const n=`${Me}:${Fe(JSON.stringify(e.model))}`;return Ie[n]=L()+t,ke||(ke=Promise.resolve().then(()=>{const r=JSON.parse(globalThis.localStorage.getItem(Me))||{},i=L();for(const o of Object.keys(r))!Ie[o]&&r[o]<i&&(globalThis.localStorage.removeItem(o),delete r[o]);globalThis.localStorage.setItem(Me,JSON.stringify({...r,...Ie})),ke=null})),n}function dn(e,t){const n=A(e);if(typeof t!="function")throw TypeError(`The second argument must be a function: ${typeof t}`);const r=F.get(n)||new Set;return r.add(t),F.set(n,r),()=>{r.delete(t),r.size===0&&F.delete(n)}}function Vt(e,t){typeof t=="function"&&(t={get:t});const n={cache:!0,loose:!1,...t};if(n.observe){const r=n.observe;if(typeof r!="function")throw TypeError(`Storage 'observe' property must be a function: ${typeof r}`);const i=F.get(e)||new Set;i.add(r),F.set(e,i)}if(n.cache===!1||n.cache===0)n.validate=r=>!r||Ae(r)===L();else if(typeof n.cache=="number")n.validate=r=>!r||Ae(r)+n.cache>L();else{if(n.cache!==!0)throw TypeError(`Storage 'cache' property must be a boolean or number: ${typeof n.cache}`);n.validate=r=>Ae(r)!==1}if(n.get||(n.get=r=>{throw le(B(r))}),n.offline)try{const r=n.offline===!0,i=r?1e3*60*60*24*30:n.offline,o=un(e,i),s=JSON.parse(globalThis.localStorage.getItem(o))||{};let l;n.offline=Object.freeze({key:o,threshold:i,get:r?f=>hasOwnProperty.call(s,f)?JSON.parse(s[f][1]):null:f=>{if(hasOwnProperty.call(s,f)){const h=s[f];return h[0]+i<L()?(delete s[f],null):JSON.parse(h[1])}return null},set(f,h){return h?s[f]=[L(),JSON.stringify(h,function(c,a){if(a===this[""])return a;if(a&&typeof a=="object"){const T=O.get(a);if(T===e&&a.id===f)return String(a);if(T&&T.storage.offline)return T.list?a.map(b=>(Se.get(T.model).storage.offline.set(b.id,b),`${b}`)):(T.storage.offline.set(a.id,a),`${a}`)}return a})]:delete s[f],l||(l=Promise.resolve().then(()=>{const u=L();for(const c of Object.keys(s))s[c][0]+i<u&&delete s[c];globalThis.localStorage.setItem(o,JSON.stringify(s)),l=null})),h}})}catch(r){console.error("Error while setup offline cache",r),n.offline=!1}return Object.freeze(n)}function pn(e){return{get:e.enumerable?()=>null:()=>e.create({}),set:e.enumerable?(t,n)=>n:(t,n)=>n===null?{id:t}:n,list:e.enumerable&&function(n){if(n)throw TypeError("Memory-based model definition does not support id");const r=[];for(const{key:i,value:o}of Wt(e))i!==e&&o&&!Ce(o)&&r.push(i);return r},loose:!0}}function A(e,t){return Array.isArray(e)?yn(e[0],t):Ut(e,t)}function ut(e,t){switch(e){case"string":return n=>n!=null?String(n):"";case"number":return Number;case"boolean":return Boolean;default:throw TypeError(`The value of the '${t}' must be a string, number or boolean: ${e}`)}}function W(e,t,n){const r=k(e,"state").value;return Qe(e,"state",{state:t,value:n,error:(t==="error"?n:r?.error)||!1},!0),e}function Q(e){return _(e,"state",(t,n={state:"ready",error:!1})=>n)}function Bt(e){return e?(e^Math.random()*16>>e/4).toString(16):("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,Bt)}const tt=new WeakSet,Ue=new WeakMap;function hn(e){if(typeof e!="function")throw TypeError(`The first argument must be a function: ${typeof e}`);return tt.add(e),e}function mn(e){if(e==null)throw TypeError(`The value must be defined: ${e}`);if(!tt.has(e)&&typeof e=="function")throw TypeError("A function is not supported as the value of the record");const t=Object.freeze({});return Ue.set(t,e),t}const Ft=new WeakMap;function gn(e,t,n){let r=n.model[t];if(tt.has(r)&&(r=r()),Ue.has(r)){const o=Ue.get(r);if(typeof o=="function")throw TypeError(`A function is not supported as the value of the record for '${t}' property`);return{defaultValue:{id:!0,value:o},type:"record"}}let i=typeof r;if(r instanceof String||r instanceof Number||r instanceof Boolean){const o=Ft.get(r);if(!o)throw TypeError(N(e,`You must use primitive ${typeof r.valueOf()} value for '${t}' property of the provided model definition`));r=r.valueOf(),i=typeof r,n.checks.set(t,o)}return{defaultValue:r,type:i}}function N(e,t){return`${t}

Model definition:

${JSON.stringify(e,null,2)}
`}const bn=Promise.resolve(),Se=new WeakMap;function Ut(e,t){if(typeof e!="object"||e===null)throw TypeError(`Model definition must be an object: ${typeof e}`);let n=Se.get(e);if(n&&!n.enumerable){if(t&&!n.nested)throw TypeError(N(e,"Provided model definition for nested object already used as a root definition"));if(!t&&n.nested)throw TypeError(N(e,"Nested model definition cannot be used outside of the parent definition"))}if(!n){const r=e[Ze];typeof r=="object"&&Object.freeze(r);let i;const o=hasOwnProperty.call(e,"id"),s=!!r,l=new Map,f={};Object.defineProperty(f,"toString",{value:function(){return this.id}});const h=Object.create(f);n={model:e,external:s,enumerable:o,nested:!o&&!s&&t,placeholder:c=>{const a=Object.create(h);return O.set(a,n),ve.set(a,Ee),o&&(a.id=c),Object.freeze(a)},isInstance:c=>Object.getPrototypeOf(c)!==h,invalidate:()=>{i||(i=bn.then(()=>{Ne(n,n,{clearValue:!0}),i=null}))},checks:l},Se.set(e,n),n.storage=Vt(n,r||pn(n));const u=Object.keys(Object.freeze(e)).map(c=>{if(c!=="id"&&Object.defineProperty(h,c,{get(){throw Error(N(e,`Model instance in ${Q(this).state} state - use store.pending(), store.error(), or store.ready() guards`))},enumerable:!0}),c==="id"){if(e[c]!==!0)throw TypeError(N(e,"The 'id' property in the model definition must be set to 'true' or not be defined"));return(v,b,d)=>{let p;hasOwnProperty.call(b,"id")?p=nt(b.id):d?p=d.id:p=Bt(),Object.defineProperty(v,"id",{value:p,enumerable:!0})}}const{defaultValue:a,type:T}=gn(e,c,n);switch(T){case"function":return v=>{Object.defineProperty(v,c,{get(){return _(this,c,()=>a(this))}})};case"object":{if(a===null)throw TypeError(`The value for the '${c}' must be an object instance: ${a}`);if(Array.isArray(a)){const d=typeof a[0];if(d==="undefined")throw TypeError(`The first item of the '${c}' array must be defined`);if(d!=="object"){if(d==="function"&&![String,Number,Boolean].includes(a[0]))throw TypeError(`The array item for the '${c}' must be one of the primitive types constructor: String, Number, or Boolean`);const g=d==="function"?a[0]:ut(d,c),$=d==="function"?[]:Object.freeze(a.map(g));return(m,y,w)=>{if(hasOwnProperty.call(y,c)){if(!Array.isArray(y[c]))throw TypeError(`The value for '${c}' property must be an array: ${typeof y[c]}`);m[c]=Object.freeze(y[c].map(g))}else w&&hasOwnProperty.call(w,c)?m[c]=w[c]:m[c]=$}}const p=A(a,!0);if(p.external&&n.storage.offline&&p.storage.offline&&p.storage.offline.threshold<n.storage.offline.threshold)throw Error(`External nested model for '${c}' property has lower offline threshold (${p.storage.offline.threshold} ms) than the parent definition (${n.storage.offline.threshold} ms)`);if(p.enumerable&&a[1]){const g=a[1];if(typeof g!="object")throw TypeError(`Options for '${c}' array property must be an object instance: ${typeof g}`);g.loose&&(n.contexts=n.contexts||new Set,n.contexts.add(A(a[0])))}return(g,$,m)=>{if(hasOwnProperty.call($,c)){if(!Array.isArray($[c]))throw TypeError(`The value for '${c}' property must be an array: ${typeof $[c]}`);g[c]=p.create($[c],!0)}else g[c]=m&&m[c]||!p.enumerable&&p.create(a)||[]}}if(Object.keys(a).length===0)throw TypeError(`The object for the '${c}' must have at least one property`);const b=A(a,!0);if(b.enumerable||b.external){if(n.storage.offline&&b.storage.offline&&b.storage.offline.threshold<n.storage.offline.threshold)throw Error(`External nested model for '${c}' property has lower offline threshold (${b.storage.offline.threshold} ms) than the parent definition (${n.storage.offline.threshold} ms)`);return(d,p,g)=>{let $;if(hasOwnProperty.call(p,c)){const m=p[c];if(typeof m!="object"||m===null)m!=null&&($={id:m});else{const y=O.get(m);if(y){if(y.model!==a)throw TypeError("Model instance must match the definition");$=m}else{const w=k(b,p[c].id).value;$=b.create(m,w&&b.isInstance(w)?w:void 0),U(b,$.id,$)}}}else $=g&&g[c];if($){const m=$.id;Object.defineProperty(d,c,{get(){return _(this,c,()=>M(a,m))},enumerable:!0})}else d[c]=void 0}}return(d,p,g)=>{hasOwnProperty.call(p,c)?d[c]=p[c]===null?b.create({}):b.create(p[c],g&&g[c]):d[c]=g?g[c]:b.create({})}}case"record":{const v=A(a,!0);return(b,d,p)=>{if(d[c]===null){b[c]={};return}if(d[c]===void 0){b[c]=p?.[c]??{};return}if(typeof d[c]!="object")throw TypeError(`The value for the '${c}' must be an object instance: ${typeof d[c]}`);const g=d[c];let $={};if(p)for(const m of Object.keys(p[c]))hasOwnProperty.call(g,m)||Object.defineProperty($,m,{get(){return p[c][m]},enumerable:!0,configurable:!0});for(const m of Object.keys(g)){if(g[m]===null)continue;const y=v.create({id:m,value:g[m]},{id:m,value:p&&p[c][m]});Object.defineProperty($,m,{get(){return _(this,m,()=>y.value)},enumerable:!0})}b[c]=$}}default:{const v=ut(T,c);return(b,d,p)=>{hasOwnProperty.call(d,c)?b[c]=v(d[c]):p&&hasOwnProperty.call(p,c)?b[c]=p[c]:b[c]=a}}}});n.create=function(a,T){if(a===null)return null;if(typeof a!="object")throw TypeError(`Model values must be an object instance: ${a}`);const v=Object.create(f);for(const b of u)b(v,a,T);return O.set(v,n),ve.set(v,Ee),Object.freeze(v)},Object.freeze(h),Object.freeze(n)}return n}const dt=Object.getOwnPropertyNames(Array.prototype).reduce((e,t)=>(t==="length"||t==="constructor"||Object.defineProperty(e,t,{get(){throw Error(N(M(O.get(this).model),`Model list instance in ${Q(this).state} state - use store.pending(), store.error(), or store.ready() guards`))}}),e),[]),Je=new WeakMap;function yn(e,t){let n=Je.get(e);if(n&&!n.enumerable&&!t&&n.nested)throw TypeError(N(e,"Nested model definition cannot be used outside of the parent definition"));if(!n){const r=Ut(e),i=new Set;if(r.storage.loose&&i.add(r),!t){if(!r.enumerable)throw TypeError(N(e,"Provided model definition does not support listing (it must be enumerable - set `id` property to `true`)"));if(!r.storage.list)throw TypeError(N(e,"Provided model definition storage does not support `list` action"))}t=!r.enumerable&&!r.external&&t,n={list:!0,nested:t,model:e,contexts:i,enumerable:r.enumerable,external:r.external,placeholder:o=>{const s=Object.create(dt);return O.set(s,n),Object.defineProperties(s,{id:{value:o},toString:{value:function(){return this.id}}}),Object.freeze(s)},isInstance:o=>Object.getPrototypeOf(o)!==dt,create(o,s=!1){if(o===null)return null;const l=[];for(const f of o){let h;if(typeof f=="object"&&f!==null){h=B(f.id);const u=O.get(f);let c=f;if(u){if(u.model!==e)throw TypeError("Model instance must match the definition")}else{const a=r.enumerable&&k(r,h).value;c=r.create(f,a&&r.isInstance(a)?a:void 0),r.enumerable&&(h=B(c.id),U(r,h,c,s))}r.enumerable||l.push(c)}else{if(!r.enumerable)throw TypeError(`Model instance must be an object: ${typeof f}`);h=B(f)}if(r.enumerable){const u=l.length;Object.defineProperty(l,u,{get(){return _(this,u,()=>M(e,h))},enumerable:!0})}}return Object.defineProperties(l,{id:{value:o.id},toString:{value:function(){return this.id}}}),O.set(l,n),ve.set(l,Ee),Object.freeze(l)}},n.storage=Object.freeze({...Vt(n,{cache:r.storage.cache,get:!t&&(o=>r.storage.list(o))}),offline:r.storage.offline&&{threshold:r.storage.offline.threshold,get:o=>{const s=B(o);let l=r.storage.offline.get(Fe(String(s)));return l?(l=l.map(f=>r.storage.offline.get(f)),l.id=s,l):null},set:(o,s)=>{r.storage.offline.set(Fe(String(B(o))),s.map(l=>(r.storage.offline.set(l.id,l),l.id)))}}}),Je.set(e,Object.freeze(n))}return n}function nt(e){if(typeof e!="object")return e!==void 0?String(e):e;const t={};for(const n of Object.keys(e).sort()){if(typeof e[n]=="object"&&e[n]!==null)throw TypeError(`You must use primitive value for '${n}' key: ${typeof e[n]}`);t[n]=e[n]}return t}function B(e){return e=nt(e),typeof e=="object"?JSON.stringify(e):e}const wn=new WeakSet;function le(e,t){const n=Error(N(e,`Model instance ${t!==void 0?`with '${t}' id `:""}does not exist`));return wn.add(n),n}function re(e,t){return W(e,"error",t)}function M(e,t){const n=A(e);let r;if(n.enumerable){if(r=B(t),!r&&!n.list&&!ae.get(n))throw TypeError(N(e,`Provided model definition requires non-empty id: "${r}"`))}else if(t!==void 0)throw TypeError(N(e,`Provided model definition does not support id: ${JSON.stringify(t)}`));const{offline:i,validate:o}=n.storage,s=k(n,r),l=s.value;return l&&Q(l).state!=="pending"&&!o(l)&&(s.resolved=!1),_(n,r,()=>{t=nt(t);let f=!0;if(n.contexts)for(const a of n.contexts)_(a,a,()=>L())===L()&&(f=!1);if(f&&l&&o(l))return l;const h=()=>l||i&&n.create(i.get(r))||n.placeholder(t);let u;try{u=n.storage.get(t)}catch(a){return be(re(h(),a))}if(!(u instanceof Promise)&&u!==void 0&&typeof u!="object")throw TypeError(N(e,`Storage 'get' method must return a Promise, an instance, or null: ${u}`));try{if(typeof u!="object"||u===null)throw i&&i.set(r,null),le(e,r)}catch(a){return be(re(h(),a))}if(u instanceof Promise)return u=u.then(a=>{if(a!==void 0&&typeof a!="object")throw TypeError(N(e,`Storage 'get' method must resolve to an instance, or null: ${a}`));if(typeof a!="object"||a===null)throw i&&i.set(r,null),le(e,r);a.id!==t&&(a.id=t);const T=n.create(a);return i&&i.set(r,T),U(n,r,be(T))}).catch(a=>U(n,r,re(h(),a))),W(h(),"pending",u);u.id!==t&&(u.id=t);const c=n.create(u);return i&&Promise.resolve().then(()=>{i.set(r,c)}),et(n,be(c),l)})}const ae=new WeakMap;function pt(e){const t=Object.keys(e),n=Error(`Model validation failed (${t.join(", ")}) - read the details from 'errors' property`);return n.errors=e,n}function oe(e,t={}){let n=O.get(e);if(n===null&&(e=Pe.get(e),n=O.get(e)),n===null)throw Error("Provided model instance has expired. Haven't you used stale value?");let r=!!n;if(n||(n=A(e)),n.nested)throw N(n.model,TypeError("Setting provided nested model instance is not supported, use the root model instance"));if(n.list)throw TypeError("Listing model definition does not support 'set' method");if(!n.storage.set)throw N(n.model,TypeError("Provided model definition storage does not support 'set' method"));if(!r&&!n.enumerable&&(r=!0,e=M(e)),r){const a=Y(e);if(a)return a.then(T=>oe(T,t))}const i=ae.get(n);let o;if(n.enumerable&&!r&&(!t||typeof t!="object"))throw TypeError(`Values must be an object instance: ${t}`);if(!i&&t&&hasOwnProperty.call(t,"id"))throw TypeError(`Values must not contain 'id' property: ${t.id}`);const s=n.create(t,r?e:void 0),l=t?Object.keys(t):[],f={},h=r&&i&&Ce(e);let u=!1;if(s&&n.checks.size)for(const[a,T]of n.checks.entries()){if(l.indexOf(a)===-1&&(h&&h.errors&&h.errors[a]&&(u=!0,f[a]=h.errors[a]),i&&s[a]==n.model[a]))continue;let v;try{v=T(s[a],a,s)}catch(b){v=b}v!==!0&&v!==void 0&&(u=!0,f[a]=v||!0)}let c;try{if(u&&!i)throw pt(f);o=s?s.id:e.id,c=n.storage.set(r?o:void 0,s,l)}catch(a){return r&&W(e,"error",a),Promise.reject(a)}if(!(c instanceof Promise)&&c!==void 0&&typeof c!="object")throw TypeError(N(n.model,`Storage 'set' method must return a Promise, an instance, or null: ${c}`));return c=Promise.resolve(c).then(a=>{if(a!==void 0&&typeof a!="object")throw TypeError(N(n.model,`Storage 'set' method must resolve to an instance or null: ${a}`));const T=a===s?s:n.create(a);if(r&&T&&o!==T.id)throw TypeError(N(n.model,`Local and storage data must have the same id: '${o}', '${T.id}'`));let v=T?T.id:o;return u&&i&&W(T,"error",pt(f)),i&&r&&hasOwnProperty.call(a,"id")&&(!s||s.id!==e.id)?v=e.id:n.storage.offline&&n.storage.offline.set(v,T),U(n,v,T||re(n.placeholder(v),le(n.model,o)),!0)}).catch(a=>{throw a=a!==void 0?a:Error("Undefined error"),r&&W(e,"error",a),a}),r&&W(e,"pending",c),c}function Tn(e,t){if(typeof t!="object")throw TypeError(`Values must be an object instance: ${t}`);let n=O.get(e);if(n===null&&(e=Pe.get(e),n=O.get(e)),n===null)throw Error("Provided model instance has expired. Haven't you used stale value?");if(n===void 0){if(!t)throw TypeError("Values must be defined for usage with model definition");n=A(e),e=void 0}else if(t&&hasOwnProperty.call(t,"id"))throw TypeError(`Values must not contain 'id' property: ${t.id}`);if(n.list)throw TypeError("Listing model definition is not supported in sync method");const r=n.create(t,e),i=t?r.id:e.id;return U(n,i,r||re(n.placeholder(i),le(n.model,i)))}function rt(e,t=!0){if(typeof e!="object"||e===null)throw TypeError(`The first argument must be a model instance or a model definition: ${e}`);let n=O.get(e);if(n===null)throw Error("Provided model instance has expired. Haven't you used stale value from the outer scope?");if(n){const r=t&&n.storage.offline;r&&r.set(e.id,null),ft(e),Ne(n,e.id,{clearValue:t,deleteEntry:t})}else{if(!Se.get(e)&&!Je.get(e[0]))return;n=A(e);const r=t&&n.storage.offline;for(const i of Wt(n))i.key!==n&&(r&&r.set(i.key,null),ft(i.value));Dt(n,{clearValue:t,deleteEntry:t})}}function Y(...e){let t=!1;const n=e.map(r=>{try{const{state:i,value:o}=Q(r);if(i==="pending")return t=!0,o}catch{}return Promise.resolve(r)});return t&&(e.length>1?Promise.all(n):n[0])}function Jt(e,t){e=Pe.get(e)||e,O.get(e)||(e=M(e,t));const n=Y(e);if(!n){const r=Ce(e);return r?Promise.reject(r):Promise.resolve(e)}return n.then(r=>Jt(r))}function Ce(e,t){if(e===null||typeof e!="object")return!1;const n=Q(e);if(t!==void 0){const r=typeof n.error=="object"&&n.error&&n.error.errors;return t===null?!r&&n.error:r[t]}return n.error}function qe(...e){return e.length>0&&e.every(t=>{const n=O.get(t);return!!(n&&n.isInstance(t))})}function ht(e,t){return e={...e,...t},delete e.id,e}function vn(e,t={}){const n=O.get(e);if(!n||!ae.has(n))throw TypeError(`Provided model instance is not a draft: ${e}`);if(Y(e))throw Error("Model draft in pending state");const r=ae.get(n);let i;if(k(r,e.id).value){const o=M(r.model,e.id);i=Promise.resolve(Y(o)||o).then(s=>oe(s,ht(e,t)))}else i=oe(r.model,ht(e,t));return i=i.then(o=>(W(e,"ready"),oe(e,o).then(()=>o))).catch(o=>(W(e,"error",o),Promise.reject(o))),W(e,"pending",i),i}function $n(e,t){return!!e||`${t} is required`}function Sn(e,t=$n,n=""){switch(typeof e){case"string":e=new String(e);break;case"number":e=new Number(e);break;case"boolean":e=new Boolean(e);break;default:throw TypeError(`Default value must be a string, number or boolean: ${typeof e}`)}let r;if(t instanceof RegExp)r=i=>t.test(i)||n;else if(typeof t=="function")r=(...i)=>{const o=t(...i);return o!==!0&&o!==void 0&&n||o};else throw TypeError(`The second argument must be a RegExp instance or a function: ${typeof t}`);return Ft.set(e,r),e}function qt(e){return e&&O.has(e)?e.id:e??void 0}function mt(e,t,n){if(n=qt(n),!t.enumerable&&!t.list)return M(e,n);const r=_t(),i=n!==void 0||t.list?M(e,n):void 0;if(r&&i&&i.id!==r.id&&qe(r)&&!qe(i)){const o=O.get(r),s=Object.freeze(Object.create(r));return O.set(s,o),Qe(s,"state",Q(i),!0),s}return i}function gt(e,t,n,r){const i=_t();if(n=qt(n??i?.id),n===void 0&&!i&&r==null)if(t.enumerable){const o=t.create({});n=o.id,U(t,o.id,o,!1)}else rt(t.model);return M(e,n)}function Ee(e,t={}){const n=A(e);if(t.id!==void 0&&typeof t.id!="function"){const i=t.id;t.id=o=>o[i]}if(t.id&&!n.enumerable)throw TypeError("Store factory for singleton model definition does not support 'id' option");let r;if(t.draft){if(n.list)throw TypeError("Draft mode is not supported for listing model definition");return r=A({...e,[Ze]:{get(i){const o=M(n.model,i);return Y(o)||o},set(i,o){return o===null?{id:i}:o}}}),ae.set(r,n),e=r.model,{value:t.id?(i,o)=>gt(e,r,t.id(i),o):(i,o)=>gt(e,r,o,o),connect:n.enumerable?(i,o)=>()=>{rt(i[o],!0)}:void 0}}return{value:t.id?i=>mt(e,n,t.id(i)):(i,o)=>mt(e,n,o)}}const x=Object.freeze(Object.assign(Ee,{connect:Ze,get:M,set:oe,sync:Tn,clear:rt,pending:Y,error:Ce,ready:qe,submit:vn,value:Sn,resolve:Jt,ref:hn,record:mn,observe:dn})),En=globalThis.document&&globalThis.document.startViewTransition!==void 0&&function e(t){return async function n(r,i){if(t.useLayout=n.useLayout,e.instance){console.warn(`${He(r)}: view transition already in progress`),e.instance.finished.finally(()=>{t(r,i)});return}e.instance=globalThis.document.startViewTransition(()=>{t(r,i)}),e.instance.finished.finally(()=>{e.instance=void 0})}}||(e=>e),ie=new WeakMap;function V(e){let t=ie.get(e);return t||(ie.set(e,t={}),t)}function Le(e){let t;for(;e&&(t=V(e))&&t.endNode;)e=t.endNode;return e}function fe(e){if(e.nodeType===globalThis.Node.TEXT_NODE){const t=ie.get(e);if(t&&t.startNode){const n=Le(t.endNode);let r=t.startNode;const i=n.nextSibling;for(;r;){const o=r.nextSibling;r.parentNode.removeChild(r),r=o!==i&&o}ie.set(e,{})}}else{let t=e.childNodes[0];for(;t;)e.removeChild(t),t=e.childNodes[0];ie.set(e,{})}}const On=Date.now(),J=(e=0)=>`H-${On}-${e}`,ze=/^\d+$/,xn={block:(e,t)=>({display:"block","text-align":t}),inline:({display:e})=>({display:`inline${e?`-${e}`:""}`}),contents:{display:"contents"},hidden:{display:"none"},...["row","row-reverse","column","column-reverse"].reduce((e,t)=>(e[t]=(n,r="nowrap")=>({display:"flex","flex-flow":`${t} ${r}`}),e),{}),grow:(e,t=1)=>({"flex-grow":t}),shrink:(e,t=1)=>({"flex-shrink":t}),basis:(e,t)=>({"flex-basis":S(t)}),order:(e,t=0)=>({order:t}),grid:(e,t="1",n="",r="",i="")=>({display:"grid",...["columns","rows"].reduce((o,s)=>{const l=s==="columns"?t:n;return o[`grid-template-${s}`]=l&&l.split("|").map(f=>f.match(ze)?`repeat(${f}, minmax(0, 1fr))`:S(f)).join(" "),o},{}),"grid-auto-flow":`${r} ${i&&"dense"}`}),area:(e,t="",n="")=>({"grid-column":t.match(ze)?`span ${t}`:t,"grid-row":n.match(ze)?`span ${n}`:n}),gap:(e,t=1,n="")=>({"column-gap":S(t),"row-gap":S(n||t)}),items:(e,t="start",n="")=>({"place-items":`${t} ${n}`}),content:(e,t="start",n="")=>({"place-content":`${t} ${n}`}),self:(e,t="start",n="")=>({"place-self":`${t} ${n}`}),center:{"place-items":"center","place-content":"center"},size:(e,t,n=t)=>({width:S(t),height:S(n),"box-sizing":"border-box"}),width:(e,t,n,r)=>({width:S(t),"min-width":S(n),"max-width":S(r),"box-sizing":"border-box"}),height:(e,t,n,r)=>({height:S(t),"min-height":S(n),"max-height":S(r),"box-sizing":"border-box"}),ratio:(e,t)=>({"aspect-ratio":t}),overflow:(e,t="hidden",n="")=>{const r=n?`-${t}`:"",i=n||t;return{[`overflow${r}`]:i,...i==="scroll"?{"flex-grow":e["flex-grow"]||1,"flex-basis":0,"overscroll-behavior":"contain","--webkit-overflow-scrolling":"touch"}:{}}},margin:(e,t="1",n,r,i)=>t.match(/top|bottom|left|right/)?{[`margin-${t}`]:S(n||"1")}:{margin:`${S(t)} ${S(n)} ${S(r)} ${S(i)}`},padding:(e,t="1",n,r,i)=>t.match(/top|bottom|left|right/)?{[`padding-${t}`]:S(n||"1")}:{padding:`${S(t)} ${S(n)} ${S(r)} ${S(i)}`},absolute:{position:"absolute"},relative:{position:"relative"},fixed:{position:"fixed"},sticky:{position:"sticky"},static:{position:"static"},inset:(e,t=0)=>{const n=S(t);return{top:n,right:n,bottom:n,left:n}},top:(e,t=0)=>({top:S(t)}),bottom:(e,t=0)=>({bottom:S(t)}),left:(e,t=0)=>({left:S(t)}),right:(e,t=0)=>({right:S(t)}),layer:(e,t=1)=>({"z-index":t}),"":(e,t,...n)=>{if(n.length<2)throw new Error("Generic rule '::' requires at least two arguments, eg.: ::[property]:[name]");return{[n[n.length-2]]:`var(--${n.join("-")})`}},view:(e,t)=>({"view-transition-name":t})},Nn={min:"min-content",max:"max-content",fit:"fit-content",full:"100%"},jn={print:"print",portrait:"(orientation: portrait)",landscape:"(orientation: landscape)",hover:"(hover: hover)","any-hover":"(any-hover: hover)"};function S(e){return e=Nn[e]||e,/^-?\d+(\.\d+)*$/.test(String(e))?`${e*8}px`:e||""}const ot=!!(globalThis.document&&globalThis.document.adoptedStyleSheets);let K;function Kt(){if(K)return K;if(ot)K=new globalThis.CSSStyleSheet;else{const e=globalThis.document.createElement("style");e.appendChild(globalThis.document.createTextNode("")),globalThis.document.head.appendChild(e),K=e.sheet}return K.insertRule(":host([hidden]) { display: none; }"),K}const bt=new WeakMap;let Ke=new WeakSet;function Pn(e){const t=e.getRootNode();if(Ke.has(t))return;const n=Kt();if(ot&&t.adoptedStyleSheets)t.adoptedStyleSheets=[...t.adoptedStyleSheets,n];else{if(t===globalThis.document)return;let r=bt.get(t);r||(r=globalThis.document.createElement("style"),t.appendChild(r),bt.set(t,r));let i="";for(let o=0;o<n.cssRules.length;o++)i+=n.cssRules[o].cssText;r.textContent=i}Ke.add(t)}const yt=new Map;function wt(e,t,n,r){let i=yt.get(e);i||(i=`l-${Math.random().toString(36).substr(2,5)}`,yt.set(e,i)),ot||(Ke=new WeakSet);const o=Kt(),[s,l=""]=t.split("@"),f=Object.entries(n.replace(/\s+/g," ").trim().split(" ").reduce((u,c)=>{const[a,...T]=c.split(":"),v=xn[a];if(!v)throw TypeError(`Unsupported layout rule: '${a}'`);return Object.assign(u,typeof v=="function"?v(u,...T.map(b=>b.match(/--.*/)?`var(${b})`:b)):v)},{})).reduce((u,[c,a])=>a!==void 0&&a!==""?u+`${c}: ${a};`:u,""),h=l.split(":").map(u=>u.split("|").map(c=>c&&(jn[c]||`(min-width: ${c})`)).join(" and ")).join(", ");if(r){const u=`:host(:where(.${i}-s${s}))`,c=`:where(.${i}-c${s})`;[u,c].forEach(a=>{o.insertRule(h?`@media ${h} { ${a} { ${f} } }`:`${a} { ${f} }`,o.cssRules.length-1)})}else{const u=`.${i}${s}`;o.insertRule(h?`@media ${h} { ${u} { ${f} } }`:`${u} { ${f} }`,o.cssRules.length-1)}return i}const Xe=new WeakMap;function Cn(e,t){const n=V(e),r=n.startNode,i=Le(n.endNode);t.parentNode.insertBefore(e,t.nextSibling);let o=e,s=r;for(;s;){const l=s.nextSibling;o.parentNode.insertBefore(s,o.nextSibling),o=s,s=l!==i.nextSibling&&l}}function Ln(e,t,n,r,i){let o=Xe.get(t);const s=n.map((u,c)=>({id:hasOwnProperty.call(u,"id")?u.id:c,value:u,placeholder:null,available:!0}));if(Xe.set(t,s),o){const u=new Set;for(const c of s)u.add(c.id);o=o.filter(c=>u.has(c.id)?!0:(fe(c.placeholder),c.placeholder.parentNode.removeChild(c.placeholder),!1))}let l=t;const f=n.length-1,h=V(t);for(let u=0;u<s.length;u+=1){const c=s[u];let a;if(o){for(let T=0;T<o.length;T+=1)if(o[T].available&&o[T].id===c.id){a=o[T];break}}a?(a.available=!1,c.placeholder=a.placeholder,c.placeholder.previousSibling!==l&&Cn(c.placeholder,l),a.value!==c.value&&r(e,c.placeholder,c.value,a.value,i)):(c.placeholder=globalThis.document.createTextNode(""),l.parentNode.insertBefore(c.placeholder,l.nextSibling),r(e,c.placeholder,c.value,void 0,i)),l=Le(V(c.placeholder).endNode||c.placeholder),u===0&&(h.startNode=c.placeholder),u===f&&(h.endNode=l)}if(o)for(const u of o)u.available&&(fe(u.placeholder),u.placeholder.parentNode.removeChild(u.placeholder))}function An(e,t,n){fe(t);const r=V(t);r.startNode=r.endNode=n,t.parentNode.insertBefore(n,t.nextSibling)}function Tt(e){const t=typeof e;if(t==="object"){if(Array.isArray(e))return"array";if(e instanceof globalThis.Node)return"node"}return t}function ue(e,t,n,r,i){const o=Tt(n),s=Tt(r);switch(s!=="undefined"&&o!==s&&(o!=="function"&&fe(t),s==="array"?Xe.delete(t):s!=="node"&&s!=="function"&&(t.textContent="")),o){case"array":Ln(e,t,n,ue,i);break;case"node":An(e,t,n);break;case"function":i&&(n.useLayout=!0),n(e,t);break;default:t.textContent=o==="number"||n?n:""}}const We=new WeakMap;function Mn(e){return(t,n,r,i)=>{if(i){const o=We.get(n);n.removeEventListener(e,o.get(i),i.options!==void 0?i.options:!1)}if(r){if(typeof r!="function")throw Error(`Event listener must be a function: ${typeof r}`);let o=We.get(n);o||(o=new WeakMap,We.set(n,o));const s=r.bind(null,t);o.set(r,s),n.addEventListener(e,s,r.options!==void 0?r.options:!1)}}}function _e(e,t){if(t)for(const n of String(t).split(/\s+/))n&&e.add(n)}function In(e){const t=new Set;if(Array.isArray(e))for(const n of e)_e(t,n);else if(e!==null&&typeof e=="object")for(const[n,r]of Object.entries(e))n&&r&&_e(t,n);else _e(t,e);return t}const vt=new WeakMap;function kn(e,t,n){const r=vt.get(t)||new Set,i=In(n);vt.set(t,i);for(const o of i)t.classList.add(o),r.delete(o);for(const o of r)t.classList.remove(o)}const $t=new WeakMap;function zn(e,t,n){if(n===null||typeof n!="object")throw TypeError(`Style value must be an object in ${He(t)}:`,n);const r=$t.get(t)||new Map,i=new Map;for(const o of Object.keys(n)){const s=pe(o),l=n[o];!l&&l!==0?t.style.removeProperty(s):t.style.setProperty(s,l),i.set(s,l),r.delete(s)}for(const o of r.keys())t.style[o]="";$t.set(t,i)}function Wn(e,t,n){if(n===!1||n===void 0||n===null)e.removeAttribute(t);else{const r=n===!0?"":String(n);e.setAttribute(t,r)}}function _n(e,t,n){if(t.substr(0,2)==="on"){const r=t.substr(2);return Mn(r)}switch(e){case"class":return kn;case"style":return zn;default:{let r;return(i,o,s)=>{r===void 0&&(r=o.tagName!=="svg",r&&(r=t in o,r||(t=e.replace(/-./g,l=>l[1].toUpperCase()),r=t in o))),r?o[t]=s:Wn(o,e,s)}}}}const Xt=J("(\\d+)"),te=new RegExp(`^${Xt}$`),X=new RegExp(Xt,"g"),Rn=/^[^A-Za-z]+$/;function Dn(e){let t=e[0],n=!1;for(let r=1;r<e.length;r+=1)n=n||t.match(/<\s*(table|th|tr|td|thead|tbody|tfoot|caption|colgroup)([^<>]|"[^"]*"|'[^']*')*>\s*$/),t+=(n?`<!--${J(r-1)}-->`:J(r-1))+e[r],n=n&&!t.match(/<\/\s*(table|th|tr|td|thead|tbody|tfoot|caption|colgroup)\s*>/);return t}function Gn(e){return e.replace(/\s*=\s*['"]*$/g,"").split(/\s+/).pop()}function St(e){return globalThis.document.createTreeWalker(e,globalThis.NodeFilter.SHOW_ELEMENT|globalThis.NodeFilter.SHOW_TEXT|globalThis.NodeFilter.SHOW_COMMENT,null,!1)}function Vn(e,t=0){e=e.replace(/(^[\n\s\t ]+)|([\n\s\t ]+$)+/g,"");let n=e.indexOf(`
`);if(n>-1){let r=0-t-2;for(n+=1;e[n]===" "&&n<e.length;n+=1)r+=1;return e.replace(/\n +/g,i=>i.substr(0,Math.max(i.length-r,1)))}return e}function Et(e,t){const n=J(t);return`${Vn(e).split(`
`).filter(i=>i).map(i=>{const o=i.indexOf(n);return o>-1?`| ${i}
--${"-".repeat(o)}${"^".repeat(6)}`:`| ${i}`}).join(`
`).replace(X,"${...}")}`}const Ot=new Map,Oe=new WeakMap,xt=new WeakMap;function Bn(e,t){const n=Oe.get(e);if(!n&&!t||t?.length&&n?.length&&t?.every((s,l)=>n[l]===s))return;let r=null;if(t){r=[];for(const s of t){let l=s;l instanceof globalThis.CSSStyleSheet||(l=Ot.get(s),l||(l=new globalThis.CSSStyleSheet,l.replaceSync(s),Ot.set(s,l))),r.push(l)}}let i;const o=xt.get(e);if(o){i=[];for(const s of e.adoptedStyleSheets)o.includes(s)||i.push(s)}if(r){i=i||e.adoptedStyleSheets.length?[...e.adoptedStyleSheets]:[];for(const s of r)i.push(s)}e.adoptedStyleSheets=i,Oe.set(e,t),xt.set(e,r)}const Re=new WeakMap;function Nt(e,t){let n=Re.get(e);if(t){const r=Oe.get(e);if(r&&t.every((i,o)=>r[o]===i))return;(!n||n.parentNode!==e)&&(n=globalThis.document.createElement("style"),Re.set(e,n),e=Le(e),e.nodeType===globalThis.Node.TEXT_NODE?e.parentNode.insertBefore(n,e.nextSibling):e.appendChild(n)),n.textContent=t.join(`
/*------*/
`),Oe.set(e,t)}else n&&(n.parentNode.removeChild(n),Re.set(e,null))}function Fn(e,t,n,r){let i="";i=Dn(e);let o=globalThis.document.createElement("template");o.innerHTML=i;let s;const l=o.content.children[0];if(l instanceof globalThis.HTMLTemplateElement){for(const d of Array.from(l.attributes)){const p=d.value.trim();if(p&&d.name.startsWith("layout")){if(p.match(X))throw Error("Layout attribute cannot contain expressions");s=wt(l,d.name.substr(6),p,!0)}}if(s!==void 0&&o.content.children.length>1)throw Error("Template, which uses layout system must have only the '<template>' root element");r=s||l.hasAttribute("layout"),o=l}const f=St(o.content),h={},u=[];let c=0,a=null,T=!1,v=!1;for(;f.nextNode();){let d=f.currentNode;if(a&&!a.contains(d)&&(a=null),d.nodeType===globalThis.Node.COMMENT_NODE&&te.test(d.textContent)&&(d.parentNode.insertBefore(globalThis.document.createTextNode(d.textContent),d.nextSibling),f.nextNode(),d.parentNode.removeChild(d),d=f.currentNode),d.nodeType===globalThis.Node.TEXT_NODE){let p=d.textContent;const g=p.match(te);if(g)d.textContent="",h[g[1]]=[c,ue];else{if(ir()&&!a&&!p.match(/^\s*$/)){let m;const y=p.trim(),w=y.replace(/\s+/g," ").replace(X,(E,j)=>(j=Number(j),m===void 0&&(m=j),`\${${j-m}}`));if(!w.match(Rn)){let E=d.previousSibling&&d.previousSibling.nodeType===globalThis.Node.COMMENT_NODE?d.previousSibling:"";E&&(E.parentNode.removeChild(E),c-=1,E=(E.textContent.split("|")[1]||"").trim().replace(/\s+/g," "));const j=sr(w,E).replace(/\${(\d+)}/g,(R,D)=>J(Number(D)+m));p=p.replace(y,j),d.textContent=p}}const $=p.match(X);if($){let m=d;$.reduce((y,w)=>{const[E,j]=y.pop().split(w);return E&&y.push(E),y.push(w),j&&y.push(j),y},[p]).forEach((y,w)=>{w===0?m.textContent=y:(m=m.parentNode.insertBefore(globalThis.document.createTextNode(y),m.nextSibling),f.currentNode=m,c+=1);const E=m.textContent.match(te);E&&(m.textContent="",h[E[1]]=[c,ue])})}}}else if(d.nodeType===globalThis.Node.ELEMENT_NODE){(d.tagName==="STYLE"||d.tagName==="SLOT"||d.tagName==="LINK"&&d.rel==="stylesheet")&&(T=!0,v=v||d.tagName==="SLOT"),!a&&(d.getAttribute("translate")==="no"||d.tagName.toLowerCase()==="script"||d.tagName.toLowerCase()==="style")&&(a=d);const p=d.tagName.toLowerCase();p.match(/.+-.+/)&&!globalThis.customElements.get(p)&&!u.includes(p)&&u.push(p);for(const g of Array.from(d.attributes)){const $=g.value.trim(),m=g.name;if(r&&m.startsWith("layout")&&$){if($.match(X))throw Error("Layout attribute cannot contain expressions");const w=wt(d,m.substr(6),$);d.removeAttribute(m),d.classList.add(w);continue}const y=$.match(te);if(y){const w=Gn(e[y[1]]);h[y[1]]=[c,_n(m,w)],d.removeAttribute(g.name)}else{const w=$.match(X);if(w){const E=`attr__${m}`;for(const[j,R]of w.entries()){const[,D]=R.match(te);let z=!1;h[D]=[c,(G,I,Qt)=>{const Z=V(I);Z[E]=(Z[E]||$).replace(R,Qt??""),(w.length===1||j+1===w.length)&&(z=z||!(I instanceof globalThis.SVGElement)&&m in I,z?I[m]=Z[E]:I.setAttribute(m,Z[E]),Z[E]=void 0)},!0]}g.value=""}}}}c+=1}u.length&&console.warn(`Not defined ${u.map(d=>`<${d}>`).join(", ")} element${u.length>1?"s":""} found in the template:
${Et(i,-1)}`);const b=Object.keys(h);return function(p,g,$,m){if(g){if(v&&!p.shadowRoot)throw TypeError("The <slot> element found - use 'shadow' options to explicitly define Shadow DOM mode")}else g=p.shadowRoot||(T||m)&&p.attachShadow({mode:"open"})||p;let y=V(g);if(o!==y.template){const w=globalThis.document.importNode(o.content,!0),E=St(w),j=[];let R=0,D=0,z=h[b[D]];for(;E.nextNode();){const G=E.currentNode;for(;z&&z[0]===R;)j.push({index:b[D],node:G,fn:z[1],forceUpdate:z[2]}),D+=1,z=h[b[D]];R+=1}if(y.hostLayout&&p.classList.remove(y.hostLayout),fe(g),y=V(g),y.template=o,y.markers=j,g.nodeType===globalThis.Node.TEXT_NODE){Nt(g),y.startNode=w.childNodes[0],y.endNode=w.childNodes[w.childNodes.length-1];let G=g,I=w.childNodes[0];for(;I;)g.parentNode.insertBefore(I,G.nextSibling),G=I,I=w.childNodes[0]}else{if(r&&s){const G=`${s}-${p===g?"c":"s"}`;p.classList.add(G),y.hostLayout=G}g.appendChild(w)}r&&Pn(g)}g.adoptedStyleSheets?Bn(g,m):Nt(g,m);for(const w of y.markers){const E=$[w.index];let j;if(!(y.prevArgs&&(j=y.prevArgs[w.index],j===E&&!w.forceUpdate)))try{w.fn(p,w.node,E,j,r)}catch(R){throw console.error(`Error while updating template expression in ${He(p)}:
${Et(i,w.index)}`),R}}return y.prevArgs=$,g}}const De=new WeakMap;function Un(e,t,n=200){return function r(i,o){const s=r.useLayout;let l;t&&(l=setTimeout(()=>{l=void 0,ue(i,o,t,void 0,s)},n)),De.set(o,e),e.then(f=>{l&&clearTimeout(l),De.get(o)===e&&(ue(i,o,f,t&&!l?t:void 0,s),De.set(o,null))})}}function jt({target:e,detail:t},n){let r;switch(e.type){case"radio":case"checkbox":r=e.checked&&e.value;break;case"file":r=e.files;break;default:r=t&&hasOwnProperty.call(t,"value")?t.value:e.value}n(r)}function Jn(e,t){return e.split(".").reverse().reduce((n,r)=>n?{[r]:n}:{[r]:t},null)}const Pt=new Map;function qn(e,t){if(!e)throw Error(`The first argument must be a property name or an object instance: ${e}`);if(typeof e=="object"){if(t===void 0)throw Error("For model instance property the second argument must be defined");const r=ve.get(e);if(!r)throw Error("Provided object must be a model instance of the store");return t===null?()=>{r.set(e,null)}:(i,o)=>{jt(o,s=>{r.set(e,Jn(t,s))})}}if(arguments.length===2)return r=>{r[e]=t};let n=Pt.get(e);return n||(n=(r,i)=>{jt(i,o=>{r[e]=o})},Pt.set(e,n)),n}const Kn=Object.freeze(Object.defineProperty({__proto__:null,resolve:Un,set:qn,transition:En},Symbol.toStringTag,{value:"Module"}));function Xn(e){return this.id=e,this}function Hn(...e){return this.styleSheets=this.styleSheets||[],this.styleSheets.push(...e),this}function Yn(e,...t){this.styleSheets=this.styleSheets||[];let n=e[0];for(let r=1;r<e.length;r++)n+=(t[r-1]!==void 0?t[r-1]:"")+e[r];return this.styleSheets.push(n),this}function Qn(e){return this.plugins=this.plugins||[],this.plugins.push(e),this}const Zn=Object.freeze(Object.defineProperty({__proto__:null,css:Yn,key:Xn,style:Hn,use:Qn},Symbol.toStringTag,{value:"Module"})),er=J(),tr=J("layout"),Ct=new Map;function nr(e,t,n,r,i){function o(s,l){o.useLayout&&(n+=tr);let f=Ct.get(n);return f||(f=Fn(e,r,i,o.useLayout),Ct.set(n,f)),o.plugins?o.plugins.reduce((h,u)=>u(h),()=>f(s,l,t,o.styleSheets))(s,l):f(s,l,t,o.styleSheets)}return Object.assign(o,Zn)}function C(e,...t){const n=e.join(er);return nr(e,t,n,!1,!1)}Object.freeze(Object.assign(C,Kn));const we=new Map,Lt=new Map;let rr=null;const or=(()=>{let e;try{e=globalThis.navigator.languages||[globalThis.navigator.language]}catch{e=[]}return e.reduce((t,n)=>{const r=n.split("-")[0];return t.add(n),n!==r&&t.add(r),t},new Set)})();function ir(){return we.size}const At=new Map;function sr(e,t,n=[]){e=e.trim().replace(/\s+/g," "),t=t.trim();const r=`${e} | ${t}`;let i=Lt.get(r);if(!i){if(we.size)for(const o of or){const s=we.get(o);if(s&&(i=s[r]||s[e],i)){if(i=i.message,typeof i=="object"){let l=At.get(o);l||(l=new Intl.PluralRules(o),At.set(o,l));const f=i;i=h=>h===0&&f.zero||f[l.select(h)]||f.other||""}break}}i||i||(i=e,(we.size||rr)&&console.warn(`Missing translation: "${e}"${t?` [${t}]`:""}`)),Lt.set(r,i)}return typeof i=="function"?i(n[0]):i}const de={price:-1,timestamp:-1,[x.connect]:{get:async()=>{const e="https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd",t="https://min-api.cryptocompare.com/data/price?fsym=BTC&tsyms=USD";try{const n=await fetch(e);if(!n.ok)throw new Error(`CoinGecko request failed: ${n.statusText}`);const i=(await n.json()).bitcoin.usd;return console.log("Fetched price from CoinGecko:",i),{price:i,timestamp:Date.now()}}catch(n){console.warn("Primary price source (CoinGecko) failed:",n),console.log("Trying fallback price source (CryptoCompare)...");const r=await fetch(t);if(!r.ok)throw console.error("BTCPrice store fetch error:",`HTTP error! status: ${r.status}`),new Error(`CryptoCompare request failed: ${r.statusText}`);const o=(await r.json()).USD;return console.log("Fetched price from CryptoCompare:",o),{price:o,timestamp:Date.now()}}},cache:1e4}},cr=async()=>(x.clear(de,!1),x.resolve(de));je({tag:"btc-price",price:x(de),render:({price:e})=>C`
        <div class="btc-price">
            <strong>BTC Price:</strong> ${x.ready(e)?`$${e.price}`:"Loading..."}
        </div>
    `});const Te=new Map,ye={};function lr(e){if(typeof window>"u"||!window.localStorage)return console.warn("localStorage is not available. Guesses will not be persisted."),{get:r=>ye[r]||null,set:(r,i)=>{if(i===null)r&&delete ye[r];else{const o=r||i.id;ye[o]=i}return i},list:()=>Object.values(ye)};const t=JSON.parse(localStorage.getItem(e)||"{}"),n=()=>{localStorage.setItem(e,JSON.stringify(t))};return{get:r=>t[r]||null,set:(r,i)=>{if(i===null)r&&delete t[r];else{const o=r||i.id;t[o]=i}return n(),i},list:()=>Object.values(t)}}const Ge=new WeakMap,Ht=6e4;function ar(e){return e.status!=="resolved"||e.initialPrice===-1||e.resolutionPrice===-1||e.direction===""?"pending":e.direction==="up"&&e.resolutionPrice>e.initialPrice||e.direction==="down"&&e.resolutionPrice<e.initialPrice?"correct":"incorrect"}const q={id:!0,direction:"",status:"new",initialPrice:-1,initialTimestamp:-1,secondsLeft:Math.round(Ht/1e3),resolutionPrice:-1,resolutionTimestamp:-1,outcome:e=>ar(e),playerId:"",[x.connect]:{...lr("btc-guesses"),loose:!0}};function Yt(){const e=it();return!!e&&(e.status==="new"||e.status==="pending")}function fr(e){const t=Date.now();return{direction:e.direction,status:"new",outcome:"pending",initialPrice:e.initialPrice,initialTimestamp:t,playerId:e.playerId}}function it(){const e=x.get([q]);return!Array.isArray(e)||e.length===0?null:e.reduce((t,n)=>n.initialTimestamp>t.initialTimestamp?n:t)}function ur(e){if(!e)return 0;const t=Math.max(0,Ht/1e3-Math.floor((Date.now()-e)/1e3));return isNaN(t)?0:t}function Mt(e){return ur(e.initialTimestamp)}function It(e){let t;"guess"in e&&e.guess?t=e.guess.id:"id"in e&&(t=e.id),t&&Te.has(t)&&(window.clearInterval(Te.get(t)),Te.delete(t)),"activeCountdownGuessId"in e&&(e.activeCountdownGuessId=null)}async function dr(e){if(Ge.get(e)){console.log("Countdown setup already in progress. Exiting.");return}Ge.set(e,!0);try{if(!Yt())return;const t=it();if(!e.guess||!e.guess.id||!t||e.guess.id!==t.id)return;if(e.guess.status==="new"||e.guess.status==="pending"){let n=e.guess;n.status==="new"&&(n=await x.set(n,{status:"pending"}));const r=Mt(n);e.secondsLeft=r,n=await x.set(n,{secondsLeft:r});let i=0;const o=async()=>{const l=x.get(q,n.id);if(!l||l.status!=="pending"){console.log("Guess is no longer pending. Stopping interval."),It(e);return}const f=Mt(l);if(e.secondsLeft=f,await x.set(l,{secondsLeft:f}),console.log("tick:",f),f<=0){const h=Date.now();if(h-i>=5e3){i=h,console.log("Polling for price change...");const c=(await cr())?.price;c!==void 0&&c!==l.initialPrice?(console.log(`Price changed from ${l.initialPrice} to ${c}. Resolving.`),await x.set(l,{status:"resolved",resolutionPrice:c,resolutionTimestamp:Date.now()}),It(e)):console.log(`Price is ${c}, same as initial ${l.initialPrice}. Continuing to poll.`)}}},s=window.setInterval(o,1e3);Te.set(n.id,s)}}finally{Ge.set(e,!1)}}async function kt(e,t){if(e.disabled)return;const n=fr({direction:t,playerId:e.playerId,initialPrice:e.price.price});await x.set(q,n),typeof window<"u"&&(window.__guesses__=x.get([q]))}je({tag:"guess-component",playerId:"",price:x(de),guess:x(q),disabled:()=>Yt(),render:({price:e,guess:t,disabled:n})=>C`
        <div>
            ${x.ready(e)?C`
                <button id="guess-up" disabled=${n} onclick="${r=>kt(r,"up")}">Up</button>
                <button id="guess-down" disabled=${n} onclick="${r=>kt(r,"down")}">Down</button>
                ${n?"":C`
                    <div>Please make a guess.</div>
                `}
            `:C`
                <div>Loading price...</div>
            `}
        </div>
    `});je({tag:"guess-evaluator",price:x(de),guesses:x([q]),guess:{value:()=>it()||!1,observe:(e,t)=>{!t||e.activeCountdownGuessId===t.id||t&&(t.status==="new"||t.status==="pending")&&(e.activeCountdownGuessId=t.id,dr(e))}},secondsLeft:60,activeCountdownGuessId:null,render:({guess:e,guesses:t,secondsLeft:n})=>e?e.status==="new"||e.status==="pending"?n>0?C`
                    <div>
                        <span>Comparing in: ${n}s</span>
                    </div>
                `:C`
                    <div>
                        <span>Looking for price change</span>
                    </div>
                `:e.status==="resolved"?C`
                <div>
                    <span>Guess resolved: 
                        ${e.outcome==="correct"?" Correct":e.outcome==="incorrect"?" Incorrect":"..."}</span>
                </div>
            `:C`
            <div>Unknown guess status</div>`:C`
            <div>No guess, ${t.length} guesses made</div>`});function pr(e){if(!Array.isArray(e))return{correct:0,incorrect:0,total:0};const t=e.filter(i=>i.status==="resolved"),n=t.filter(i=>i.outcome==="correct").length,r=t.filter(i=>i.outcome==="incorrect").length;return{correct:n,incorrect:r,total:t.length}}const hr={guesses:x([q]),score:({guesses:e})=>pr(e),render:({score:e})=>C`
        <style>
            :host {
                display: block;
                border: 1px solid #ccc;
                padding: 16px;
                border-radius: 8px;
                margin-top: 20px;
                text-align: center;
            }

            .score-grid {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 1rem;
                margin-top: 1rem;
            }

            .score-item {
                background-color: #f9f9f9;
                border: 1px solid #eee;
                border-radius: 4px;
                padding: 1rem;
            }

            .score-item h3 {
                margin: 0 0 0.5rem;
                font-size: 0.9rem;
                font-weight: 500;
                color: #666;
            }

            .score-item p {
                margin: 0;
                font-size: 1.8rem;
                font-weight: bold;
            }
        </style>
        <h2>Score</h2>
        <div class="score-grid">
            <div class="score-item">
                <h3>Correct</h3>
                <p>${e.correct}</p>
            </div>
            <div class="score-item">
                <h3>Incorrect</h3>
                <p>${e.incorrect}</p>
            </div>
            <div class="score-item">
                <h3>Total</h3>
                <p>${e.total}</p>
            </div>
        </div>
    `};je({tag:"score-component",...hr});
